{"ast":null,"code":"/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { arrays, LookupCall, QueryBy, scout, strings } from '../index';\nimport $ from 'jquery';\nexport default class PrepopulatedLookupCall extends LookupCall {\n  constructor() {\n    super();\n    this.lookupRows = [];\n  }\n  setLookupRows(lookupRows) {\n    this.lookupRows = arrays.ensure(lookupRows);\n  }\n  _filterActiveLookupRow(lookupRow) {\n    return !!scout.nvl(lookupRow.active, true);\n  }\n\n  // --- ALL ---\n\n  _getAll() {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByAll.bind(this, deferred));\n    return deferred.promise();\n  }\n  _queryByAll(deferred) {\n    deferred.resolve({\n      queryBy: QueryBy.ALL,\n      lookupRows: this._lookupRowsByAll()\n    });\n  }\n  _lookupRowsByAll() {\n    return this.lookupRows.filter(this._filterActiveLookupRow, this).slice(0, this.maxRowCount);\n  }\n\n  // --- TEXT ---\n\n  _getByText(text) {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByText.bind(this, deferred, text));\n    return deferred.promise();\n  }\n  _queryByText(deferred, text) {\n    deferred.resolve({\n      queryBy: QueryBy.TEXT,\n      text: text,\n      lookupRows: this._lookupRowsByText(text)\n    });\n  }\n  _lookupRowsByText(text) {\n    let filterText = String(scout.nvl(text, '')).trim().toLowerCase();\n    return this.lookupRows.filter(lookupRow => {\n      return strings.startsWith(scout.nvl(lookupRow.text, '').toLowerCase(), filterText);\n    }).filter(this._filterActiveLookupRow, this).slice(0, this.maxRowCount);\n  }\n\n  // --- KEY ---\n\n  _getByKey(key) {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByKey.bind(this, deferred, key));\n    return deferred.promise();\n  }\n  _queryByKey(deferred, key) {\n    let lookupRow = this._lookupRowByKey(key);\n    if (lookupRow) {\n      deferred.resolve({\n        queryBy: QueryBy.KEY,\n        lookupRows: [lookupRow]\n      });\n    } else {\n      deferred.reject();\n    }\n  }\n  _lookupRowByKey(key) {\n    return arrays.find(this.lookupRows, lookupRow => {\n      return lookupRow.key === key;\n    });\n  }\n\n  // --- REC ---\n\n  _getByRec(rec) {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByRec.bind(this, deferred, rec));\n    return deferred.promise();\n  }\n  _queryByRec(deferred, rec) {\n    deferred.resolve({\n      queryBy: QueryBy.REC,\n      rec: rec,\n      lookupRows: this._lookupRowsByRec(rec)\n    });\n  }\n  _lookupRowsByRec(rec) {\n    return this.lookupRows.reduce((aggr, lookupRow) => {\n      if (lookupRow.parentKey === rec) {\n        aggr.push(lookupRow);\n      }\n      return aggr;\n    }, []).filter(this._filterActiveLookupRow, this).slice(0, this.maxRowCount);\n  }\n}","map":{"version":3,"names":["arrays","LookupCall","QueryBy","scout","strings","$","PrepopulatedLookupCall","constructor","lookupRows","setLookupRows","ensure","_filterActiveLookupRow","lookupRow","nvl","active","_getAll","deferred","Deferred","setTimeout","_queryByAll","bind","promise","resolve","queryBy","ALL","_lookupRowsByAll","filter","slice","maxRowCount","_getByText","text","_queryByText","TEXT","_lookupRowsByText","filterText","String","trim","toLowerCase","startsWith","_getByKey","key","_queryByKey","_lookupRowByKey","KEY","reject","find","_getByRec","rec","_queryByRec","REC","_lookupRowsByRec","reduce","aggr","parentKey","push"],"sources":["C:/workspace/ddhub/ddhub/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/lookup/PrepopulatedLookupCall.js"],"sourcesContent":["/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {arrays, LookupCall, QueryBy, scout, strings} from '../index';\nimport $ from 'jquery';\n\nexport default class PrepopulatedLookupCall extends LookupCall {\n\n  constructor() {\n    super();\n    this.lookupRows = [];\n  }\n\n  setLookupRows(lookupRows) {\n    this.lookupRows = arrays.ensure(lookupRows);\n  }\n\n  _filterActiveLookupRow(lookupRow) {\n    return !!scout.nvl(lookupRow.active, true);\n  }\n\n  // --- ALL ---\n\n  _getAll() {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByAll.bind(this, deferred));\n    return deferred.promise();\n  }\n\n  _queryByAll(deferred) {\n    deferred.resolve({\n      queryBy: QueryBy.ALL,\n      lookupRows: this._lookupRowsByAll()\n    });\n  }\n\n  _lookupRowsByAll() {\n    return this.lookupRows\n      .filter(this._filterActiveLookupRow, this)\n      .slice(0, this.maxRowCount);\n  }\n\n  // --- TEXT ---\n\n  _getByText(text) {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByText.bind(this, deferred, text));\n    return deferred.promise();\n  }\n\n  _queryByText(deferred, text) {\n    deferred.resolve({\n      queryBy: QueryBy.TEXT,\n      text: text,\n      lookupRows: this._lookupRowsByText(text)\n    });\n  }\n\n  _lookupRowsByText(text) {\n    let filterText = String(scout.nvl(text, '')).trim().toLowerCase();\n    return this.lookupRows\n      .filter(lookupRow => {\n        return strings.startsWith(scout.nvl(lookupRow.text, '').toLowerCase(), filterText);\n      })\n      .filter(this._filterActiveLookupRow, this)\n      .slice(0, this.maxRowCount);\n  }\n\n  // --- KEY ---\n\n  _getByKey(key) {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByKey.bind(this, deferred, key));\n    return deferred.promise();\n  }\n\n  _queryByKey(deferred, key) {\n    let lookupRow = this._lookupRowByKey(key);\n    if (lookupRow) {\n      deferred.resolve({\n        queryBy: QueryBy.KEY,\n        lookupRows: [lookupRow]\n      });\n    } else {\n      deferred.reject();\n    }\n  }\n\n  _lookupRowByKey(key) {\n    return arrays.find(this.lookupRows, lookupRow => {\n      return lookupRow.key === key;\n    });\n  }\n\n  // --- REC ---\n\n  _getByRec(rec) {\n    let deferred = $.Deferred();\n    setTimeout(this._queryByRec.bind(this, deferred, rec));\n    return deferred.promise();\n  }\n\n  _queryByRec(deferred, rec) {\n    deferred.resolve({\n      queryBy: QueryBy.REC,\n      rec: rec,\n      lookupRows: this._lookupRowsByRec(rec)\n    });\n  }\n\n  _lookupRowsByRec(rec) {\n    return this.lookupRows\n      .reduce((aggr, lookupRow) => {\n        if (lookupRow.parentKey === rec) {\n          aggr.push(lookupRow);\n        }\n        return aggr;\n      }, [])\n      .filter(this._filterActiveLookupRow, this)\n      .slice(0, this.maxRowCount);\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
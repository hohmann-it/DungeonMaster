{"ast":null,"code":"/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { AbstractLayout, Dimension, FormField, graphics, HtmlComponent, HtmlEnvironment } from '../../../index';\nexport default class TabBoxLayout extends AbstractLayout {\n  constructor(tabBox) {\n    super();\n    this._tabBox = tabBox;\n    this._initDefaults();\n    this.htmlPropertyChangeHandler = this._onHtmlEnvironmentPropertyChange.bind(this);\n    HtmlEnvironment.get().on('propertyChange', this.htmlPropertyChangeHandler);\n    this._tabBox.one('remove', () => {\n      HtmlEnvironment.get().off('propertyChange', this.htmlPropertyChangeHandler);\n    });\n  }\n  _initDefaults() {\n    this._statusWidth = HtmlEnvironment.get().fieldStatusWidth;\n  }\n  _onHtmlEnvironmentPropertyChange() {\n    this._initDefaults();\n    this._tabBox.invalidateLayoutTree();\n  }\n  layout($container) {\n    let containerSize,\n      tabContentSize,\n      headerMargins,\n      innerHeaderSize,\n      htmlContainer = HtmlComponent.get($container),\n      htmlTabContent = HtmlComponent.get(this._tabBox._$tabContent),\n      htmlHeader = HtmlComponent.get(this._tabBox.header.$container),\n      headerWidthHint = 0,\n      headerSize = new Dimension(),\n      tooltip = this._tabBox._tooltip(),\n      $status = this._tabBox.$status,\n      statusPosition = this._tabBox.statusPosition;\n    containerSize = htmlContainer.availableSize().subtract(htmlContainer.insets());\n    if (htmlHeader.isVisible()) {\n      headerMargins = htmlHeader.margins();\n      headerWidthHint = containerSize.subtract(headerMargins).width;\n      if ($status && $status.isVisible()) {\n        this._layoutStatus();\n        if (statusPosition === FormField.StatusPosition.DEFAULT) {\n          headerWidthHint -= this._statusWidth + graphics.margins($status).horizontal();\n        }\n      }\n      innerHeaderSize = htmlHeader.prefSize({\n        widthHint: headerWidthHint\n      });\n      if ($status && $status.isVisible()) {\n        this._layoutStatus(innerHeaderSize.height);\n      }\n      innerHeaderSize.width = headerWidthHint;\n      htmlHeader.setSize(innerHeaderSize);\n      headerSize = innerHeaderSize.add(headerMargins);\n    }\n    tabContentSize = containerSize.subtract(htmlTabContent.margins());\n    tabContentSize.height -= headerSize.height;\n    htmlTabContent.setSize(tabContentSize);\n\n    // Make sure tooltip is at correct position after layouting, if there is one\n    if (tooltip && tooltip.rendered) {\n      tooltip.position();\n    }\n  }\n  _layoutStatus(height) {\n    let htmlContainer = this._tabBox.htmlComp,\n      containerPadding = htmlContainer.insets({\n        includeBorder: false\n      }),\n      top = containerPadding.top,\n      right = containerPadding.right,\n      $header = this._tabBox.header.$container,\n      $status = this._tabBox.$status,\n      statusMargins = graphics.margins($status),\n      statusTop = top,\n      statusPosition = this._tabBox.statusPosition,\n      statusHeight = height - statusMargins.vertical();\n    if (statusPosition === FormField.StatusPosition.DEFAULT) {\n      statusTop += $header.cssMarginTop();\n    } else {\n      statusHeight -= $status.cssBorderWidthY(); // status has a transparent border to align icon with text\n    }\n\n    $status.cssWidth(this._statusWidth).cssTop(statusTop).cssRight(right).cssHeight(statusHeight);\n  }\n\n  /**\n   * Preferred size of the tab-box aligns every tab-item in a single line, so that each item is visible.\n   */\n  preferredLayoutSize($container, options) {\n    options = options || {};\n    let htmlContainer = HtmlComponent.get($container),\n      htmlTabContent = HtmlComponent.get(this._tabBox._$tabContent),\n      htmlHeader = HtmlComponent.get(this._tabBox.header.$container),\n      headerSize = new Dimension(),\n      tabContentSize = new Dimension(),\n      $status = this._tabBox.$status,\n      statusPosition = this._tabBox.statusPosition,\n      headerWidthHint = htmlContainer.availableSize().subtract(htmlContainer.insets()).width;\n\n    // HeightHint not supported\n    options.heightHint = null;\n    if (htmlHeader.isVisible()) {\n      if ($status && $status.isVisible()) {\n        if (statusPosition === FormField.StatusPosition.DEFAULT) {\n          headerWidthHint -= $status.outerWidth(true);\n        }\n      }\n      headerSize = htmlHeader.prefSize({\n        widthHint: headerWidthHint\n      }).add(htmlHeader.margins());\n    }\n    tabContentSize = htmlTabContent.prefSize(options).add(htmlContainer.insets()).add(htmlTabContent.margins());\n    return new Dimension(Math.max(headerSize.width, tabContentSize.width), tabContentSize.height + headerSize.height);\n  }\n}","map":{"version":3,"names":["AbstractLayout","Dimension","FormField","graphics","HtmlComponent","HtmlEnvironment","TabBoxLayout","constructor","tabBox","_tabBox","_initDefaults","htmlPropertyChangeHandler","_onHtmlEnvironmentPropertyChange","bind","get","on","one","off","_statusWidth","fieldStatusWidth","invalidateLayoutTree","layout","$container","containerSize","tabContentSize","headerMargins","innerHeaderSize","htmlContainer","htmlTabContent","_$tabContent","htmlHeader","header","headerWidthHint","headerSize","tooltip","_tooltip","$status","statusPosition","availableSize","subtract","insets","isVisible","margins","width","_layoutStatus","StatusPosition","DEFAULT","horizontal","prefSize","widthHint","height","setSize","add","rendered","position","htmlComp","containerPadding","includeBorder","top","right","$header","statusMargins","statusTop","statusHeight","vertical","cssMarginTop","cssBorderWidthY","cssWidth","cssTop","cssRight","cssHeight","preferredLayoutSize","options","heightHint","outerWidth","Math","max"],"sources":["C:/git/d-d-hub/code/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/form/fields/tabbox/TabBoxLayout.js"],"sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {AbstractLayout, Dimension, FormField, graphics, HtmlComponent, HtmlEnvironment} from '../../../index';\n\nexport default class TabBoxLayout extends AbstractLayout {\n\n  constructor(tabBox) {\n    super();\n    this._tabBox = tabBox;\n\n    this._initDefaults();\n\n    this.htmlPropertyChangeHandler = this._onHtmlEnvironmentPropertyChange.bind(this);\n    HtmlEnvironment.get().on('propertyChange', this.htmlPropertyChangeHandler);\n    this._tabBox.one('remove', () => {\n      HtmlEnvironment.get().off('propertyChange', this.htmlPropertyChangeHandler);\n    });\n  }\n\n  _initDefaults() {\n    this._statusWidth = HtmlEnvironment.get().fieldStatusWidth;\n  }\n\n  _onHtmlEnvironmentPropertyChange() {\n    this._initDefaults();\n    this._tabBox.invalidateLayoutTree();\n  }\n\n  layout($container) {\n    let containerSize, tabContentSize, headerMargins, innerHeaderSize,\n      htmlContainer = HtmlComponent.get($container),\n      htmlTabContent = HtmlComponent.get(this._tabBox._$tabContent),\n      htmlHeader = HtmlComponent.get(this._tabBox.header.$container),\n      headerWidthHint = 0,\n      headerSize = new Dimension(),\n      tooltip = this._tabBox._tooltip(),\n      $status = this._tabBox.$status,\n      statusPosition = this._tabBox.statusPosition;\n\n    containerSize = htmlContainer.availableSize()\n      .subtract(htmlContainer.insets());\n\n    if (htmlHeader.isVisible()) {\n      headerMargins = htmlHeader.margins();\n      headerWidthHint = containerSize.subtract(headerMargins).width;\n      if ($status && $status.isVisible()) {\n        this._layoutStatus();\n        if (statusPosition === FormField.StatusPosition.DEFAULT) {\n          headerWidthHint -= (this._statusWidth + graphics.margins($status).horizontal());\n        }\n      }\n      innerHeaderSize = htmlHeader.prefSize({\n        widthHint: headerWidthHint\n      });\n\n      if ($status && $status.isVisible()) {\n        this._layoutStatus(innerHeaderSize.height);\n      }\n\n      innerHeaderSize.width = headerWidthHint;\n      htmlHeader.setSize(innerHeaderSize);\n      headerSize = innerHeaderSize.add(headerMargins);\n    }\n\n    tabContentSize = containerSize.subtract(htmlTabContent.margins());\n    tabContentSize.height -= headerSize.height;\n    htmlTabContent.setSize(tabContentSize);\n\n    // Make sure tooltip is at correct position after layouting, if there is one\n    if (tooltip && tooltip.rendered) {\n      tooltip.position();\n    }\n  }\n\n  _layoutStatus(height) {\n    let htmlContainer = this._tabBox.htmlComp,\n      containerPadding = htmlContainer.insets({\n        includeBorder: false\n      }),\n      top = containerPadding.top,\n      right = containerPadding.right,\n      $header = this._tabBox.header.$container,\n      $status = this._tabBox.$status,\n      statusMargins = graphics.margins($status),\n      statusTop = top,\n      statusPosition = this._tabBox.statusPosition,\n      statusHeight = height - statusMargins.vertical();\n\n    if (statusPosition === FormField.StatusPosition.DEFAULT) {\n      statusTop += $header.cssMarginTop();\n    } else {\n      statusHeight -= $status.cssBorderWidthY(); // status has a transparent border to align icon with text\n    }\n\n    $status.cssWidth(this._statusWidth)\n      .cssTop(statusTop)\n      .cssRight(right)\n      .cssHeight(statusHeight);\n  }\n\n  /**\n   * Preferred size of the tab-box aligns every tab-item in a single line, so that each item is visible.\n   */\n  preferredLayoutSize($container, options) {\n    options = options || {};\n    let htmlContainer = HtmlComponent.get($container),\n      htmlTabContent = HtmlComponent.get(this._tabBox._$tabContent),\n      htmlHeader = HtmlComponent.get(this._tabBox.header.$container),\n      headerSize = new Dimension(),\n      tabContentSize = new Dimension(),\n      $status = this._tabBox.$status,\n      statusPosition = this._tabBox.statusPosition,\n      headerWidthHint = htmlContainer.availableSize().subtract(htmlContainer.insets()).width;\n\n    // HeightHint not supported\n    options.heightHint = null;\n\n    if (htmlHeader.isVisible()) {\n      if ($status && $status.isVisible()) {\n        if (statusPosition === FormField.StatusPosition.DEFAULT) {\n          headerWidthHint -= $status.outerWidth(true);\n        }\n      }\n      headerSize = htmlHeader.prefSize({\n        widthHint: headerWidthHint\n      })\n        .add(htmlHeader.margins());\n    }\n\n    tabContentSize = htmlTabContent.prefSize(options)\n      .add(htmlContainer.insets())\n      .add(htmlTabContent.margins());\n\n    return new Dimension(\n      Math.max(headerSize.width, tabContentSize.width),\n      tabContentSize.height + headerSize.height);\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
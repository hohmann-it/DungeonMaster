{"ast":null,"code":"/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { AppLinkKeyStroke, HtmlComponent, KeyStrokeContext, strings, Widget } from '../index';\nimport $ from 'jquery';\nexport default class Label extends Widget {\n  constructor() {\n    super();\n    this.value = null;\n    this.htmlEnabled = false;\n    this.scrollable = false;\n  }\n\n  /**\n   * @override\n   */\n  _createKeyStrokeContext() {\n    return new KeyStrokeContext();\n  }\n\n  /**\n   * @override\n   */\n  _initKeyStrokeContext() {\n    super._initKeyStrokeContext();\n    this.keyStrokeContext.registerKeyStroke(new AppLinkKeyStroke(this, this._onAppLinkAction));\n  }\n  _init(model) {\n    super._init(model);\n    this.resolveTextKeys(['value']);\n  }\n  _render() {\n    this.$container = this.$parent.appendDiv();\n    this.htmlComp = HtmlComponent.install(this.$container, this.session);\n  }\n  _renderProperties() {\n    super._renderProperties();\n    this._renderValue();\n    this._renderScrollable();\n  }\n  setValue(value) {\n    this.setProperty('value', value);\n  }\n  _renderValue() {\n    let value = this.value || '';\n    if (this.htmlEnabled) {\n      this.$container.html(value);\n\n      // Find app links and add handlers\n      this.$container.find('.app-link').on('click', this._onAppLinkAction.bind(this));\n\n      // Add handler to images to update the layout when the images are loaded\n      this.$container.find('img').on('load', this._onImageLoad.bind(this)).on('error', this._onImageError.bind(this));\n    } else {\n      this.$container.html(strings.nl2br(value));\n    }\n\n    // Because this method replaces the content, the scroll bars might have to be added or removed\n    if (this.rendered) {\n      // (only necessary if already rendered, otherwise it is done by renderProperties)\n      this._uninstallScrollbars();\n      this._renderScrollable();\n    }\n    this.invalidateLayoutTree();\n  }\n  setHtmlEnabled(htmlEnabled) {\n    this.setProperty('htmlEnabled', htmlEnabled);\n  }\n  _renderHtmlEnabled() {\n    // Render the value again when html enabled changes dynamically\n    this._renderValue();\n  }\n  setScrollable(scrollable) {\n    this.setProperty('scrollable', scrollable);\n  }\n  _renderScrollable() {\n    if (this.scrollable) {\n      this._installScrollbars();\n    } else {\n      this._uninstallScrollbars();\n    }\n  }\n  _onAppLinkAction(event) {\n    let $target = $(event.delegateTarget);\n    let ref = $target.data('ref');\n    this.triggerAppLinkAction(ref);\n  }\n  triggerAppLinkAction(ref) {\n    this.trigger('appLinkAction', {\n      ref: ref\n    });\n  }\n  _onImageLoad(event) {\n    this.invalidateLayoutTree();\n  }\n  _onImageError(event) {\n    this.invalidateLayoutTree();\n  }\n}","map":{"version":3,"names":["AppLinkKeyStroke","HtmlComponent","KeyStrokeContext","strings","Widget","$","Label","constructor","value","htmlEnabled","scrollable","_createKeyStrokeContext","_initKeyStrokeContext","keyStrokeContext","registerKeyStroke","_onAppLinkAction","_init","model","resolveTextKeys","_render","$container","$parent","appendDiv","htmlComp","install","session","_renderProperties","_renderValue","_renderScrollable","setValue","setProperty","html","find","on","bind","_onImageLoad","_onImageError","nl2br","rendered","_uninstallScrollbars","invalidateLayoutTree","setHtmlEnabled","_renderHtmlEnabled","setScrollable","_installScrollbars","event","$target","delegateTarget","ref","data","triggerAppLinkAction","trigger"],"sources":["C:/git/d-d-hub/code/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/label/Label.js"],"sourcesContent":["/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {AppLinkKeyStroke, HtmlComponent, KeyStrokeContext, strings, Widget} from '../index';\nimport $ from 'jquery';\n\nexport default class Label extends Widget {\n\n  constructor() {\n    super();\n    this.value = null;\n    this.htmlEnabled = false;\n    this.scrollable = false;\n  }\n\n  /**\n   * @override\n   */\n  _createKeyStrokeContext() {\n    return new KeyStrokeContext();\n  }\n\n  /**\n   * @override\n   */\n  _initKeyStrokeContext() {\n    super._initKeyStrokeContext();\n\n    this.keyStrokeContext.registerKeyStroke(new AppLinkKeyStroke(this, this._onAppLinkAction));\n  }\n\n  _init(model) {\n    super._init(model);\n    this.resolveTextKeys(['value']);\n  }\n\n  _render() {\n    this.$container = this.$parent.appendDiv();\n    this.htmlComp = HtmlComponent.install(this.$container, this.session);\n  }\n\n  _renderProperties() {\n    super._renderProperties();\n    this._renderValue();\n    this._renderScrollable();\n  }\n\n  setValue(value) {\n    this.setProperty('value', value);\n  }\n\n  _renderValue() {\n    let value = this.value || '';\n    if (this.htmlEnabled) {\n      this.$container.html(value);\n\n      // Find app links and add handlers\n      this.$container.find('.app-link').on('click', this._onAppLinkAction.bind(this));\n\n      // Add handler to images to update the layout when the images are loaded\n      this.$container.find('img')\n        .on('load', this._onImageLoad.bind(this))\n        .on('error', this._onImageError.bind(this));\n    } else {\n      this.$container.html(strings.nl2br(value));\n    }\n\n    // Because this method replaces the content, the scroll bars might have to be added or removed\n    if (this.rendered) { // (only necessary if already rendered, otherwise it is done by renderProperties)\n      this._uninstallScrollbars();\n      this._renderScrollable();\n    }\n\n    this.invalidateLayoutTree();\n  }\n\n  setHtmlEnabled(htmlEnabled) {\n    this.setProperty('htmlEnabled', htmlEnabled);\n  }\n\n  _renderHtmlEnabled() {\n    // Render the value again when html enabled changes dynamically\n    this._renderValue();\n  }\n\n  setScrollable(scrollable) {\n    this.setProperty('scrollable', scrollable);\n  }\n\n  _renderScrollable() {\n    if (this.scrollable) {\n      this._installScrollbars();\n    } else {\n      this._uninstallScrollbars();\n    }\n  }\n\n  _onAppLinkAction(event) {\n    let $target = $(event.delegateTarget);\n    let ref = $target.data('ref');\n    this.triggerAppLinkAction(ref);\n  }\n\n  triggerAppLinkAction(ref) {\n    this.trigger('appLinkAction', {\n      ref: ref\n    });\n  }\n\n  _onImageLoad(event) {\n    this.invalidateLayoutTree();\n  }\n\n  _onImageError(event) {\n    this.invalidateLayoutTree();\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
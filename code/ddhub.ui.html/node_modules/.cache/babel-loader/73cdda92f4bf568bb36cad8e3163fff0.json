{"ast":null,"code":"/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\n\nimport { HtmlTile, objects, strings } from '../index';\nexport default class TileTextFilter {\n  constructor() {\n    this.text = null;\n    this._htmlTileContentChangeHandler = this._onHtmlTileContentChange.bind(this);\n    this._tilePropertyChangeHandler = this._onTilePropertyChange.bind(this);\n  }\n  setText(text) {\n    text = text || '';\n    text = text.toLowerCase();\n    if (objects.equals(this.text, text)) {\n      return false;\n    }\n    this.text = text;\n    return true;\n  }\n  accept(tile) {\n    if (strings.empty(this.text)) {\n      return true;\n    }\n    let plainText = this._plainTextForTile(tile);\n    let filterText = plainText.trim().toLowerCase();\n    if (strings.empty(filterText)) {\n      return false;\n    }\n    return filterText.indexOf(this.text) > -1;\n  }\n  _plainTextForTile(tile) {\n    if (tile.plainText) {\n      return tile.plainText;\n    }\n    if (tile instanceof HtmlTile) {\n      tile.plainText = strings.plainText(tile.content) || '';\n      tile.one('propertyChange:content', this._htmlTileContentChangeHandler);\n      return tile.plainText;\n    }\n    if (!tile.parent.rendered) {\n      return '';\n    }\n    let remove = false;\n    if (!tile.rendered) {\n      tile.render();\n      remove = true;\n    }\n    tile.plainText = strings.plainText(tile.$container.html()) || '';\n    if (remove) {\n      tile.remove();\n    }\n    tile.on('propertyChange', this._tilePropertyChangeHandler);\n    return tile.plainText;\n  }\n  _onHtmlTileContentChange(event) {\n    delete event.source.plainText;\n  }\n  _onTilePropertyChange(event) {\n    if (event.propertyName === 'filterAccepted') {\n      return;\n    }\n    delete event.source.plainText;\n    event.source.off('propertyChange', this._tilePropertyChangeHandler);\n  }\n}","map":{"version":3,"names":["HtmlTile","objects","strings","TileTextFilter","constructor","text","_htmlTileContentChangeHandler","_onHtmlTileContentChange","bind","_tilePropertyChangeHandler","_onTilePropertyChange","setText","toLowerCase","equals","accept","tile","empty","plainText","_plainTextForTile","filterText","trim","indexOf","content","one","parent","rendered","remove","render","$container","html","on","event","source","propertyName","off"],"sources":["C:/git/d-d-hub/code/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/tile/TileTextFilter.js"],"sourcesContent":["/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\n\nimport {HtmlTile, objects, strings} from '../index';\n\nexport default class TileTextFilter {\n  constructor() {\n    this.text = null;\n    this._htmlTileContentChangeHandler = this._onHtmlTileContentChange.bind(this);\n    this._tilePropertyChangeHandler = this._onTilePropertyChange.bind(this);\n  }\n\n  setText(text) {\n    text = text || '';\n    text = text.toLowerCase();\n    if (objects.equals(this.text, text)) {\n      return false;\n    }\n    this.text = text;\n    return true;\n  }\n\n  accept(tile) {\n    if (strings.empty(this.text)) {\n      return true;\n    }\n    let plainText = this._plainTextForTile(tile);\n    let filterText = plainText.trim().toLowerCase();\n    if (strings.empty(filterText)) {\n      return false;\n    }\n    return filterText.indexOf(this.text) > -1;\n  }\n\n  _plainTextForTile(tile) {\n    if (tile.plainText) {\n      return tile.plainText;\n    }\n    if (tile instanceof HtmlTile) {\n      tile.plainText = strings.plainText(tile.content) || '';\n      tile.one('propertyChange:content', this._htmlTileContentChangeHandler);\n      return tile.plainText;\n    }\n    if (!tile.parent.rendered) {\n      return '';\n    }\n    let remove = false;\n    if (!tile.rendered) {\n      tile.render();\n      remove = true;\n    }\n    tile.plainText = strings.plainText(tile.$container.html()) || '';\n    if (remove) {\n      tile.remove();\n    }\n    tile.on('propertyChange', this._tilePropertyChangeHandler);\n    return tile.plainText;\n  }\n\n  _onHtmlTileContentChange(event) {\n    delete event.source.plainText;\n  }\n\n  _onTilePropertyChange(event) {\n    if (event.propertyName === 'filterAccepted') {\n      return;\n    }\n    delete event.source.plainText;\n    event.source.off('propertyChange', this._tilePropertyChangeHandler);\n  }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAQA,QAAQ,EAAEC,OAAO,EAAEC,OAAO,QAAO,UAAU;AAEnD,eAAe,MAAMC,cAAc,CAAC;EAClCC,WAAW,GAAG;IACZ,IAAI,CAACC,IAAI,GAAG,IAAI;IAChB,IAAI,CAACC,6BAA6B,GAAG,IAAI,CAACC,wBAAwB,CAACC,IAAI,CAAC,IAAI,CAAC;IAC7E,IAAI,CAACC,0BAA0B,GAAG,IAAI,CAACC,qBAAqB,CAACF,IAAI,CAAC,IAAI,CAAC;EACzE;EAEAG,OAAO,CAACN,IAAI,EAAE;IACZA,IAAI,GAAGA,IAAI,IAAI,EAAE;IACjBA,IAAI,GAAGA,IAAI,CAACO,WAAW,EAAE;IACzB,IAAIX,OAAO,CAACY,MAAM,CAAC,IAAI,CAACR,IAAI,EAAEA,IAAI,CAAC,EAAE;MACnC,OAAO,KAAK;IACd;IACA,IAAI,CAACA,IAAI,GAAGA,IAAI;IAChB,OAAO,IAAI;EACb;EAEAS,MAAM,CAACC,IAAI,EAAE;IACX,IAAIb,OAAO,CAACc,KAAK,CAAC,IAAI,CAACX,IAAI,CAAC,EAAE;MAC5B,OAAO,IAAI;IACb;IACA,IAAIY,SAAS,GAAG,IAAI,CAACC,iBAAiB,CAACH,IAAI,CAAC;IAC5C,IAAII,UAAU,GAAGF,SAAS,CAACG,IAAI,EAAE,CAACR,WAAW,EAAE;IAC/C,IAAIV,OAAO,CAACc,KAAK,CAACG,UAAU,CAAC,EAAE;MAC7B,OAAO,KAAK;IACd;IACA,OAAOA,UAAU,CAACE,OAAO,CAAC,IAAI,CAAChB,IAAI,CAAC,GAAG,CAAC,CAAC;EAC3C;EAEAa,iBAAiB,CAACH,IAAI,EAAE;IACtB,IAAIA,IAAI,CAACE,SAAS,EAAE;MAClB,OAAOF,IAAI,CAACE,SAAS;IACvB;IACA,IAAIF,IAAI,YAAYf,QAAQ,EAAE;MAC5Be,IAAI,CAACE,SAAS,GAAGf,OAAO,CAACe,SAAS,CAACF,IAAI,CAACO,OAAO,CAAC,IAAI,EAAE;MACtDP,IAAI,CAACQ,GAAG,CAAC,wBAAwB,EAAE,IAAI,CAACjB,6BAA6B,CAAC;MACtE,OAAOS,IAAI,CAACE,SAAS;IACvB;IACA,IAAI,CAACF,IAAI,CAACS,MAAM,CAACC,QAAQ,EAAE;MACzB,OAAO,EAAE;IACX;IACA,IAAIC,MAAM,GAAG,KAAK;IAClB,IAAI,CAACX,IAAI,CAACU,QAAQ,EAAE;MAClBV,IAAI,CAACY,MAAM,EAAE;MACbD,MAAM,GAAG,IAAI;IACf;IACAX,IAAI,CAACE,SAAS,GAAGf,OAAO,CAACe,SAAS,CAACF,IAAI,CAACa,UAAU,CAACC,IAAI,EAAE,CAAC,IAAI,EAAE;IAChE,IAAIH,MAAM,EAAE;MACVX,IAAI,CAACW,MAAM,EAAE;IACf;IACAX,IAAI,CAACe,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAACrB,0BAA0B,CAAC;IAC1D,OAAOM,IAAI,CAACE,SAAS;EACvB;EAEAV,wBAAwB,CAACwB,KAAK,EAAE;IAC9B,OAAOA,KAAK,CAACC,MAAM,CAACf,SAAS;EAC/B;EAEAP,qBAAqB,CAACqB,KAAK,EAAE;IAC3B,IAAIA,KAAK,CAACE,YAAY,KAAK,gBAAgB,EAAE;MAC3C;IACF;IACA,OAAOF,KAAK,CAACC,MAAM,CAACf,SAAS;IAC7Bc,KAAK,CAACC,MAAM,CAACE,GAAG,CAAC,gBAAgB,EAAE,IAAI,CAACzB,0BAA0B,CAAC;EACrE;AACF"},"metadata":{},"sourceType":"module"}
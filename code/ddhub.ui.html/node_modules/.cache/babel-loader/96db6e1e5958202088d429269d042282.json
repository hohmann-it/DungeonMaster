{"ast":null,"code":"/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { AbstractTableNavigationKeyStroke, arrays, keys } from '../../index';\nexport default class TableNavigationPageDownKeyStroke extends AbstractTableNavigationKeyStroke {\n  constructor(table) {\n    super(table);\n    this.which = [keys.PAGE_DOWN];\n    this.renderingHints.text = 'PgDn';\n    this.renderingHints.$drawingArea = ($drawingArea, event) => {\n      let viewport = this._viewportInfo();\n      if (viewport.lastRow) {\n        return viewport.lastRow.$row;\n      }\n    };\n  }\n  handle(event) {\n    let table = this.field,\n      viewport = this._viewportInfo(),\n      rows = table.visibleRows,\n      selectedRows = table.selectedRows,\n      lastSelectedRow = arrays.last(selectedRows),\n      lastActionRow = table.selectionHandler.lastActionRow,\n      lastActionRowIndex = -1,\n      newSelectedRows;\n\n    // Last row may be undefined if there is only one row visible in the viewport and this row is bigger than the viewport. In that case just scroll down.\n    // If it already is at the bottom nothing will happen\n    if (!viewport.lastRow) {\n      table.scrollPageDown();\n      viewport = this._viewportInfo();\n      if (!viewport.lastRow) {\n        return;\n      }\n    }\n    if (lastActionRow) {\n      lastActionRowIndex = rows.indexOf(lastActionRow);\n    }\n    // last action row index maybe < 0 if row got invisible (e.g. due to filtering), or if the user has not made a selection before\n    if (lastActionRowIndex < 0) {\n      lastActionRow = lastSelectedRow;\n      lastActionRowIndex = rows.indexOf(lastActionRow);\n    }\n\n    // If last row in viewport already is selected -> scroll a page down\n    // Don't do it if multiple rows are selected and user only presses page down without shift\n    if (selectedRows.length > 0 && lastActionRow === viewport.lastRow && !(selectedRows.length > 1 && !event.shiftKey)) {\n      table.scrollPageDown();\n      viewport = this._viewportInfo();\n      if (!viewport.lastRow) {\n        // May happen due to same reason as above -> Row will fill the whole viewport after scrolling\n        return;\n      }\n    }\n    if (event.shiftKey && selectedRows.length > 0) {\n      // Using lastActionRow instead of lastSelectedRow is essential if the user does a multi selection using ctrl and presses shift-pagedown afterwards\n      newSelectedRows = rows.slice(lastActionRowIndex + 1, rows.indexOf(viewport.lastRow) + 1);\n      newSelectedRows = arrays.union(selectedRows, newSelectedRows);\n    } else {\n      newSelectedRows = [viewport.lastRow];\n    }\n    table.selectionHandler.lastActionRow = viewport.lastRow;\n    table.selectRows(newSelectedRows, true);\n    if (!table.isFocused()) {\n      table.focus();\n    }\n  }\n}","map":{"version":3,"names":["AbstractTableNavigationKeyStroke","arrays","keys","TableNavigationPageDownKeyStroke","constructor","table","which","PAGE_DOWN","renderingHints","text","$drawingArea","event","viewport","_viewportInfo","lastRow","$row","handle","field","rows","visibleRows","selectedRows","lastSelectedRow","last","lastActionRow","selectionHandler","lastActionRowIndex","newSelectedRows","scrollPageDown","indexOf","length","shiftKey","slice","union","selectRows","isFocused","focus"],"sources":["C:/git/d-d-hub/code/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/table/keystrokes/TableNavigationPageDownKeyStroke.js"],"sourcesContent":["/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {AbstractTableNavigationKeyStroke, arrays, keys} from '../../index';\n\nexport default class TableNavigationPageDownKeyStroke extends AbstractTableNavigationKeyStroke {\n\n  constructor(table) {\n    super(table);\n    this.which = [keys.PAGE_DOWN];\n    this.renderingHints.text = 'PgDn';\n    this.renderingHints.$drawingArea = ($drawingArea, event) => {\n      let viewport = this._viewportInfo();\n      if (viewport.lastRow) {\n        return viewport.lastRow.$row;\n      }\n    };\n  }\n\n  handle(event) {\n    let table = this.field,\n      viewport = this._viewportInfo(),\n      rows = table.visibleRows,\n      selectedRows = table.selectedRows,\n      lastSelectedRow = arrays.last(selectedRows),\n      lastActionRow = table.selectionHandler.lastActionRow,\n      lastActionRowIndex = -1,\n      newSelectedRows;\n\n    // Last row may be undefined if there is only one row visible in the viewport and this row is bigger than the viewport. In that case just scroll down.\n    // If it already is at the bottom nothing will happen\n    if (!viewport.lastRow) {\n      table.scrollPageDown();\n      viewport = this._viewportInfo();\n      if (!viewport.lastRow) {\n        return;\n      }\n    }\n\n    if (lastActionRow) {\n      lastActionRowIndex = rows.indexOf(lastActionRow);\n    }\n    // last action row index maybe < 0 if row got invisible (e.g. due to filtering), or if the user has not made a selection before\n    if (lastActionRowIndex < 0) {\n      lastActionRow = lastSelectedRow;\n      lastActionRowIndex = rows.indexOf(lastActionRow);\n    }\n\n    // If last row in viewport already is selected -> scroll a page down\n    // Don't do it if multiple rows are selected and user only presses page down without shift\n    if (selectedRows.length > 0 && lastActionRow === viewport.lastRow && !(selectedRows.length > 1 && !event.shiftKey)) {\n      table.scrollPageDown();\n      viewport = this._viewportInfo();\n      if (!viewport.lastRow) {\n        // May happen due to same reason as above -> Row will fill the whole viewport after scrolling\n        return;\n      }\n    }\n\n    if (event.shiftKey && selectedRows.length > 0) {\n      // Using lastActionRow instead of lastSelectedRow is essential if the user does a multi selection using ctrl and presses shift-pagedown afterwards\n      newSelectedRows = rows.slice(lastActionRowIndex + 1, rows.indexOf(viewport.lastRow) + 1);\n      newSelectedRows = arrays.union(selectedRows, newSelectedRows);\n    } else {\n      newSelectedRows = [viewport.lastRow];\n    }\n\n    table.selectionHandler.lastActionRow = viewport.lastRow;\n    table.selectRows(newSelectedRows, true);\n    if (!table.isFocused()) {\n      table.focus();\n    }\n  }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQA,gCAAgC,EAAEC,MAAM,EAAEC,IAAI,QAAO,aAAa;AAE1E,eAAe,MAAMC,gCAAgC,SAASH,gCAAgC,CAAC;EAE7FI,WAAW,CAACC,KAAK,EAAE;IACjB,KAAK,CAACA,KAAK,CAAC;IACZ,IAAI,CAACC,KAAK,GAAG,CAACJ,IAAI,CAACK,SAAS,CAAC;IAC7B,IAAI,CAACC,cAAc,CAACC,IAAI,GAAG,MAAM;IACjC,IAAI,CAACD,cAAc,CAACE,YAAY,GAAG,CAACA,YAAY,EAAEC,KAAK,KAAK;MAC1D,IAAIC,QAAQ,GAAG,IAAI,CAACC,aAAa,EAAE;MACnC,IAAID,QAAQ,CAACE,OAAO,EAAE;QACpB,OAAOF,QAAQ,CAACE,OAAO,CAACC,IAAI;MAC9B;IACF,CAAC;EACH;EAEAC,MAAM,CAACL,KAAK,EAAE;IACZ,IAAIN,KAAK,GAAG,IAAI,CAACY,KAAK;MACpBL,QAAQ,GAAG,IAAI,CAACC,aAAa,EAAE;MAC/BK,IAAI,GAAGb,KAAK,CAACc,WAAW;MACxBC,YAAY,GAAGf,KAAK,CAACe,YAAY;MACjCC,eAAe,GAAGpB,MAAM,CAACqB,IAAI,CAACF,YAAY,CAAC;MAC3CG,aAAa,GAAGlB,KAAK,CAACmB,gBAAgB,CAACD,aAAa;MACpDE,kBAAkB,GAAG,CAAC,CAAC;MACvBC,eAAe;;IAEjB;IACA;IACA,IAAI,CAACd,QAAQ,CAACE,OAAO,EAAE;MACrBT,KAAK,CAACsB,cAAc,EAAE;MACtBf,QAAQ,GAAG,IAAI,CAACC,aAAa,EAAE;MAC/B,IAAI,CAACD,QAAQ,CAACE,OAAO,EAAE;QACrB;MACF;IACF;IAEA,IAAIS,aAAa,EAAE;MACjBE,kBAAkB,GAAGP,IAAI,CAACU,OAAO,CAACL,aAAa,CAAC;IAClD;IACA;IACA,IAAIE,kBAAkB,GAAG,CAAC,EAAE;MAC1BF,aAAa,GAAGF,eAAe;MAC/BI,kBAAkB,GAAGP,IAAI,CAACU,OAAO,CAACL,aAAa,CAAC;IAClD;;IAEA;IACA;IACA,IAAIH,YAAY,CAACS,MAAM,GAAG,CAAC,IAAIN,aAAa,KAAKX,QAAQ,CAACE,OAAO,IAAI,EAAEM,YAAY,CAACS,MAAM,GAAG,CAAC,IAAI,CAAClB,KAAK,CAACmB,QAAQ,CAAC,EAAE;MAClHzB,KAAK,CAACsB,cAAc,EAAE;MACtBf,QAAQ,GAAG,IAAI,CAACC,aAAa,EAAE;MAC/B,IAAI,CAACD,QAAQ,CAACE,OAAO,EAAE;QACrB;QACA;MACF;IACF;IAEA,IAAIH,KAAK,CAACmB,QAAQ,IAAIV,YAAY,CAACS,MAAM,GAAG,CAAC,EAAE;MAC7C;MACAH,eAAe,GAAGR,IAAI,CAACa,KAAK,CAACN,kBAAkB,GAAG,CAAC,EAAEP,IAAI,CAACU,OAAO,CAAChB,QAAQ,CAACE,OAAO,CAAC,GAAG,CAAC,CAAC;MACxFY,eAAe,GAAGzB,MAAM,CAAC+B,KAAK,CAACZ,YAAY,EAAEM,eAAe,CAAC;IAC/D,CAAC,MAAM;MACLA,eAAe,GAAG,CAACd,QAAQ,CAACE,OAAO,CAAC;IACtC;IAEAT,KAAK,CAACmB,gBAAgB,CAACD,aAAa,GAAGX,QAAQ,CAACE,OAAO;IACvDT,KAAK,CAAC4B,UAAU,CAACP,eAAe,EAAE,IAAI,CAAC;IACvC,IAAI,CAACrB,KAAK,CAAC6B,SAAS,EAAE,EAAE;MACtB7B,KAAK,CAAC8B,KAAK,EAAE;IACf;EACF;AACF"},"metadata":{},"sourceType":"module"}
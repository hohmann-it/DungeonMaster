{"ast":null,"code":"/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { FormFieldTile, TableField } from '../../../index';\nimport $ from 'jquery';\nexport default class TileTableField extends TableField {\n  constructor() {\n    super();\n    this._tableBlurHandler = this._onTableBlur.bind(this);\n    this._tableFocusHandler = this._onTableFocus.bind(this);\n    this._menuBarPropertyChangeHandler = this._onMenuBarPropertyChange.bind(this);\n    this._documentMouseDownHandler = this._onDocumentMouseDown.bind(this);\n  }\n  _render() {\n    super._render();\n    if (!this.session.focusManager.restrictedFocusGain) {\n      this.$container.document(true).addEventListener('mousedown', this._documentMouseDownHandler, true);\n    }\n  }\n  _remove() {\n    this.$container.document(true).removeEventListener('mousedown', this._documentMouseDownHandler, true);\n    super._remove();\n  }\n\n  /**\n   * @override\n   */\n  _renderTable() {\n    super._renderTable();\n    if (this.parent.displayStyle !== FormFieldTile.DisplayStyle.DASHBOARD) {\n      return;\n    }\n    if (this.table) {\n      this.table.$container.on('blur', this._tableBlurHandler).on('focus', this._tableFocusHandler);\n      this.table.menuBar.on('propertyChange', this._menuBarPropertyChangeHandler);\n      this._toggleHasMenuBar();\n      if (document.activeElement !== this.table.$container[0]) {\n        this._hideMenuBar(true);\n      }\n    }\n  }\n\n  /**\n   * @override\n   */\n  _removeTable() {\n    if (this.parent.displayStyle !== FormFieldTile.DisplayStyle.DASHBOARD) {\n      return;\n    }\n    if (this.table) {\n      this.table.$container.off('blur', this._tableBlurHandler).off('focus', this._tableFocusHandler);\n      this.table.menuBar.off('propertyChange', this._menuBarPropertyChangeHandler);\n    }\n    super._removeTable();\n  }\n  _onTableBlur(event) {\n    let popup = $('.popup').data('widget');\n\n    // hide menu bar if context menu popup is not attached to TileTableField\n    if (!this.has(popup)) {\n      this._hideMenuBar(true);\n    }\n  }\n  _onTableFocus(event) {\n    this._hideMenuBar(false);\n  }\n  _hideMenuBar(hiddenByUi) {\n    this.table.menuBar.hiddenByUi = hiddenByUi;\n    this.table.menuBar.updateVisibility();\n  }\n  _onMenuBarPropertyChange(event) {\n    if (event.propertyName === 'visible') {\n      this._toggleHasMenuBar();\n    }\n  }\n  _toggleHasMenuBar() {\n    if (!this.rendered && !this.rendering) {\n      return;\n    }\n    // adjust menu bar on TileTableField with the additional class has-menubar.\n    this.$container.toggleClass('has-menubar', this.table.menuBar.visible);\n  }\n  _onDocumentMouseDown(event) {\n    let $popup = $('.popup');\n    let popup = $popup.data('widget');\n    if (this.table && popup && this.table.has(popup) && $popup.has(event.target)) {\n      // Ensure focus is not removed from table when clicking on a context-menu\n      // Otherwise the menubar would get invisible while closing the context-menu (e.g. by clicking on header)\n      // This is only necessary if restrictedFocusGain is false (e.g. on mobile).\n      event.preventDefault();\n    }\n  }\n}","map":{"version":3,"names":["FormFieldTile","TableField","$","TileTableField","constructor","_tableBlurHandler","_onTableBlur","bind","_tableFocusHandler","_onTableFocus","_menuBarPropertyChangeHandler","_onMenuBarPropertyChange","_documentMouseDownHandler","_onDocumentMouseDown","_render","session","focusManager","restrictedFocusGain","$container","document","addEventListener","_remove","removeEventListener","_renderTable","parent","displayStyle","DisplayStyle","DASHBOARD","table","on","menuBar","_toggleHasMenuBar","activeElement","_hideMenuBar","_removeTable","off","event","popup","data","has","hiddenByUi","updateVisibility","propertyName","rendered","rendering","toggleClass","visible","$popup","target","preventDefault"],"sources":["C:/workspace/ddhub/ddhub/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/tile/fields/tablefield/TileTableField.js"],"sourcesContent":["/*\n * Copyright (c) 2010-2021 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {FormFieldTile, TableField} from '../../../index';\nimport $ from 'jquery';\n\nexport default class TileTableField extends TableField {\n\n  constructor() {\n    super();\n\n    this._tableBlurHandler = this._onTableBlur.bind(this);\n    this._tableFocusHandler = this._onTableFocus.bind(this);\n    this._menuBarPropertyChangeHandler = this._onMenuBarPropertyChange.bind(this);\n    this._documentMouseDownHandler = this._onDocumentMouseDown.bind(this);\n  }\n\n  _render() {\n    super._render();\n    if (!this.session.focusManager.restrictedFocusGain) {\n      this.$container.document(true).addEventListener('mousedown', this._documentMouseDownHandler, true);\n    }\n  }\n\n  _remove() {\n    this.$container.document(true).removeEventListener('mousedown', this._documentMouseDownHandler, true);\n    super._remove();\n  }\n\n  /**\n   * @override\n   */\n  _renderTable() {\n    super._renderTable();\n    if (this.parent.displayStyle !== FormFieldTile.DisplayStyle.DASHBOARD) {\n      return;\n    }\n    if (this.table) {\n      this.table.$container\n        .on('blur', this._tableBlurHandler)\n        .on('focus', this._tableFocusHandler);\n      this.table.menuBar.on('propertyChange', this._menuBarPropertyChangeHandler);\n      this._toggleHasMenuBar();\n      if (document.activeElement !== this.table.$container[0]) {\n        this._hideMenuBar(true);\n      }\n    }\n  }\n\n  /**\n   * @override\n   */\n  _removeTable() {\n    if (this.parent.displayStyle !== FormFieldTile.DisplayStyle.DASHBOARD) {\n      return;\n    }\n    if (this.table) {\n      this.table.$container\n        .off('blur', this._tableBlurHandler)\n        .off('focus', this._tableFocusHandler);\n      this.table.menuBar.off('propertyChange', this._menuBarPropertyChangeHandler);\n    }\n    super._removeTable();\n  }\n\n  _onTableBlur(event) {\n    let popup = $('.popup').data('widget');\n\n    // hide menu bar if context menu popup is not attached to TileTableField\n    if (!this.has(popup)) {\n      this._hideMenuBar(true);\n    }\n  }\n\n  _onTableFocus(event) {\n    this._hideMenuBar(false);\n  }\n\n  _hideMenuBar(hiddenByUi) {\n    this.table.menuBar.hiddenByUi = hiddenByUi;\n    this.table.menuBar.updateVisibility();\n  }\n\n  _onMenuBarPropertyChange(event) {\n    if (event.propertyName === 'visible') {\n      this._toggleHasMenuBar();\n    }\n  }\n\n  _toggleHasMenuBar() {\n    if (!this.rendered && !this.rendering) {\n      return;\n    }\n    // adjust menu bar on TileTableField with the additional class has-menubar.\n    this.$container.toggleClass('has-menubar', this.table.menuBar.visible);\n  }\n\n  _onDocumentMouseDown(event) {\n    let $popup = $('.popup');\n    let popup = $popup.data('widget');\n    if (this.table && popup && this.table.has(popup) && $popup.has(event.target)) {\n      // Ensure focus is not removed from table when clicking on a context-menu\n      // Otherwise the menubar would get invisible while closing the context-menu (e.g. by clicking on header)\n      // This is only necessary if restrictedFocusGain is false (e.g. on mobile).\n      event.preventDefault();\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
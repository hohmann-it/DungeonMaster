{"ast":null,"code":"/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { Device, FormField, Popup, scout, SmartFieldPopupLayout } from '../../../index';\nexport default class SmartFieldPopup extends Popup {\n  constructor() {\n    super();\n    this.animateRemoval = SmartFieldPopup.hasPopupAnimation();\n    this.windowPaddingX = 0;\n    this.windowPaddingY = 0;\n  }\n  _init(options) {\n    options.withFocusContext = false;\n    super._init(options);\n    this.smartField = this.parent;\n    this.proposalChooser = this._createProposalChooser();\n    this.proposalChooser.on('lookupRowSelected', this._triggerEvent.bind(this));\n    this.proposalChooser.on('activeFilterSelected', this._triggerEvent.bind(this));\n    this.smartField.on('remove', this._onRemoveSmartField.bind(this));\n    this.setLookupResult(options.lookupResult);\n    this.setStatus(options.status);\n  }\n  _createProposalChooser() {\n    let objectType = this.smartField.browseHierarchy ? 'TreeProposalChooser' : 'TableProposalChooser';\n    return scout.create(objectType, {\n      parent: this\n    });\n  }\n  _createLayout() {\n    return new SmartFieldPopupLayout(this, this.proposalChooser);\n  }\n  _render() {\n    let cssClass = this.smartField.cssClassName() + '-popup';\n    super._render();\n    this.$container.addClass(cssClass).on('mousedown', this._onContainerMouseDown.bind(this));\n    this.$container.toggleClass('alternative', this.smartField.fieldStyle === FormField.FieldStyle.ALTERNATIVE);\n    this.proposalChooser.render();\n  }\n  setLookupResult(result) {\n    this._setProperty('lookupResult', result);\n    this.proposalChooser.setLookupResult(result);\n  }\n\n  /**\n   * @returns the selected lookup row from the proposal chooser. If the row is disabled this function returns null.\n   */\n  getSelectedLookupRow() {\n    let lookupRow = this.proposalChooser.getSelectedLookupRow();\n    if (lookupRow && lookupRow.enabled) {\n      return lookupRow;\n    }\n    return null;\n  }\n  setStatus(status) {\n    this.proposalChooser.setStatus(status);\n  }\n  selectFirstLookupRow() {\n    this.proposalChooser.selectFirstLookupRow();\n  }\n  selectLookupRow() {\n    this.proposalChooser.triggerLookupRowSelected();\n  }\n\n  /**\n   * Delegates the key event to the proposal chooser.\n   */\n  delegateKeyEvent(event) {\n    event.originalEvent.smartFieldEvent = true;\n    this.proposalChooser.delegateKeyEvent(event);\n  }\n  _triggerEvent(event) {\n    this.trigger(event.type, event);\n  }\n\n  /**\n   * This event handler is called before the mousedown handler on the _document_ is triggered\n   * This allows us to prevent the default, which is important for the CellEditorPopup which\n   * should stay open when the SmartField popup is closed. It also prevents the focus blur\n   * event on the SmartField input-field.\n   */\n  _onContainerMouseDown(event) {\n    // when user clicks on proposal popup with table or tree (prevent default,\n    // so input-field does not lose the focus, popup will be closed by the\n    // proposal chooser impl.\n    return false;\n  }\n\n  // when smart-field is removed, also remove popup. Don't animate removal in that case\n  _onRemoveSmartField(event) {\n    this.animateRemoval = false;\n    this.remove();\n  }\n\n  /**\n   * @override because the icon is not in the $anchor container.\n   */\n  _isMouseDownOnAnchor(event) {\n    return this.field.$field.isOrHas(event.target) || this.field.$icon.isOrHas(event.target) || this.field.$clearIcon && this.field.$clearIcon.isOrHas(event.target);\n  }\n  _onAnimationEnd() {\n    this.proposalChooser.updateScrollbars();\n  }\n\n  // --- static helpers --- //\n\n  static hasPopupAnimation() {\n    return Device.get().supportsCssAnimation();\n  }\n}","map":{"version":3,"names":["Device","FormField","Popup","scout","SmartFieldPopupLayout","SmartFieldPopup","constructor","animateRemoval","hasPopupAnimation","windowPaddingX","windowPaddingY","_init","options","withFocusContext","smartField","parent","proposalChooser","_createProposalChooser","on","_triggerEvent","bind","_onRemoveSmartField","setLookupResult","lookupResult","setStatus","status","objectType","browseHierarchy","create","_createLayout","_render","cssClass","cssClassName","$container","addClass","_onContainerMouseDown","toggleClass","fieldStyle","FieldStyle","ALTERNATIVE","render","result","_setProperty","getSelectedLookupRow","lookupRow","enabled","selectFirstLookupRow","selectLookupRow","triggerLookupRowSelected","delegateKeyEvent","event","originalEvent","smartFieldEvent","trigger","type","remove","_isMouseDownOnAnchor","field","$field","isOrHas","target","$icon","$clearIcon","_onAnimationEnd","updateScrollbars","get","supportsCssAnimation"],"sources":["C:/git/d-d-hub/code/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/form/fields/smartfield/SmartFieldPopup.js"],"sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {Device, FormField, Popup, scout, SmartFieldPopupLayout} from '../../../index';\n\nexport default class SmartFieldPopup extends Popup {\n\n  constructor() {\n    super();\n    this.animateRemoval = SmartFieldPopup.hasPopupAnimation();\n    this.windowPaddingX = 0;\n    this.windowPaddingY = 0;\n  }\n\n  _init(options) {\n    options.withFocusContext = false;\n    super._init(options);\n\n    this.smartField = this.parent;\n    this.proposalChooser = this._createProposalChooser();\n    this.proposalChooser.on('lookupRowSelected', this._triggerEvent.bind(this));\n    this.proposalChooser.on('activeFilterSelected', this._triggerEvent.bind(this));\n    this.smartField.on('remove', this._onRemoveSmartField.bind(this));\n\n    this.setLookupResult(options.lookupResult);\n    this.setStatus(options.status);\n  }\n\n  _createProposalChooser() {\n    let objectType = this.smartField.browseHierarchy ? 'TreeProposalChooser' : 'TableProposalChooser';\n    return scout.create(objectType, {\n      parent: this\n    });\n  }\n\n  _createLayout() {\n    return new SmartFieldPopupLayout(this, this.proposalChooser);\n  }\n\n  _render() {\n    let cssClass = this.smartField.cssClassName() + '-popup';\n    super._render();\n    this.$container\n      .addClass(cssClass)\n      .on('mousedown', this._onContainerMouseDown.bind(this));\n    this.$container.toggleClass('alternative', this.smartField.fieldStyle === FormField.FieldStyle.ALTERNATIVE);\n    this.proposalChooser.render();\n  }\n\n  setLookupResult(result) {\n    this._setProperty('lookupResult', result);\n    this.proposalChooser.setLookupResult(result);\n  }\n\n  /**\n   * @returns the selected lookup row from the proposal chooser. If the row is disabled this function returns null.\n   */\n  getSelectedLookupRow() {\n    let lookupRow = this.proposalChooser.getSelectedLookupRow();\n    if (lookupRow && lookupRow.enabled) {\n      return lookupRow;\n    }\n    return null;\n  }\n\n  setStatus(status) {\n    this.proposalChooser.setStatus(status);\n  }\n\n  selectFirstLookupRow() {\n    this.proposalChooser.selectFirstLookupRow();\n  }\n\n  selectLookupRow() {\n    this.proposalChooser.triggerLookupRowSelected();\n  }\n\n  /**\n   * Delegates the key event to the proposal chooser.\n   */\n  delegateKeyEvent(event) {\n    event.originalEvent.smartFieldEvent = true;\n    this.proposalChooser.delegateKeyEvent(event);\n  }\n\n  _triggerEvent(event) {\n    this.trigger(event.type, event);\n  }\n\n  /**\n   * This event handler is called before the mousedown handler on the _document_ is triggered\n   * This allows us to prevent the default, which is important for the CellEditorPopup which\n   * should stay open when the SmartField popup is closed. It also prevents the focus blur\n   * event on the SmartField input-field.\n   */\n  _onContainerMouseDown(event) {\n    // when user clicks on proposal popup with table or tree (prevent default,\n    // so input-field does not lose the focus, popup will be closed by the\n    // proposal chooser impl.\n    return false;\n  }\n\n  // when smart-field is removed, also remove popup. Don't animate removal in that case\n  _onRemoveSmartField(event) {\n    this.animateRemoval = false;\n    this.remove();\n  }\n\n  /**\n   * @override because the icon is not in the $anchor container.\n   */\n  _isMouseDownOnAnchor(event) {\n    return this.field.$field.isOrHas(event.target) || this.field.$icon.isOrHas(event.target) || (this.field.$clearIcon && this.field.$clearIcon.isOrHas(event.target));\n  }\n\n  _onAnimationEnd() {\n    this.proposalChooser.updateScrollbars();\n  }\n\n  // --- static helpers --- //\n\n  static hasPopupAnimation() {\n    return Device.get().supportsCssAnimation();\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
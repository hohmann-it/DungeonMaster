{"ast":null,"code":"/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport { graphics, HtmlComponent, PopupLayout, scrollbars } from '../index';\nexport default class ContextMenuPopupLayout extends PopupLayout {\n  constructor(popup) {\n    super(popup);\n  }\n  _setSize(prefSize) {\n    if (this.popup.bodyAnimating) {\n      scrollbars.update(this.popup.get$Scrollable());\n      return;\n    }\n    super._setSize(prefSize);\n    scrollbars.update(this.popup.get$Scrollable());\n    let htmlBody = HtmlComponent.get(this.popup.$body);\n    htmlBody.pack();\n  }\n  invalidate(htmlSource) {\n    // If a child triggers a layout invalidation, the popup needs to be resized.\n    // This will happen for sure if a child is an image which will be loaded during the animation.\n    // Ideally, the running animations would be stopped, the popup layouted, the animations adjusted to the new bounds and then continued.\n    // This is currently too complicated to implement, so instead we let the animations finish and resize the popup at the end (but before other resize animations start).\n    if (this.popup.bodyAnimating && htmlSource && htmlSource.isDescendantOf(this.popup.htmlComp)) {\n      this.popup._toggleSubMenuQueue.unshift(() => {\n        if (!this.popup.rendered) {\n          return;\n        }\n        let oldOffset = this.popup.$body.data('text-offset');\n        this.popup._adjustTextAlignment();\n        this.popup.animateResize = true;\n        this.resizeAnimationDuration = this.popup.animationDuration;\n        this.popup.revalidateLayoutTree();\n        this.popup.animateResize = false;\n        this.popup._animateTextOffset(this.popup.$body, oldOffset);\n        this.popup.$container.promise().done(() => this.popup._processSubMenuQueue());\n      });\n    }\n  }\n  preferredLayoutSize($container, options) {\n    let htmlComp = this.popup.htmlComp;\n    let htmlBody = HtmlComponent.get(this.popup.$body);\n    let prefSize;\n    if (this.popup.bodyAnimating) {\n      prefSize = graphics.size(this.popup.$body, options);\n    } else {\n      let popupStyleBackup = this.popup.$container.attr('style');\n      let $siblingBodies = this.popup.$body.siblings('.context-menu');\n      $siblingBodies.addClass('hidden');\n      this.popup.$body.css({\n        width: 'auto',\n        height: 'auto'\n      });\n      htmlBody = HtmlComponent.get(this.popup.$body);\n      prefSize = htmlBody.prefSize(options);\n      $siblingBodies.removeClass('hidden');\n      this.popup.$container.attr('style', popupStyleBackup);\n    }\n    return prefSize.add(htmlComp.insets()).add(htmlBody.margins());\n  }\n}","map":{"version":3,"names":["graphics","HtmlComponent","PopupLayout","scrollbars","ContextMenuPopupLayout","constructor","popup","_setSize","prefSize","bodyAnimating","update","get$Scrollable","htmlBody","get","$body","pack","invalidate","htmlSource","isDescendantOf","htmlComp","_toggleSubMenuQueue","unshift","rendered","oldOffset","data","_adjustTextAlignment","animateResize","resizeAnimationDuration","animationDuration","revalidateLayoutTree","_animateTextOffset","$container","promise","done","_processSubMenuQueue","preferredLayoutSize","options","size","popupStyleBackup","attr","$siblingBodies","siblings","addClass","css","width","height","removeClass","add","insets","margins"],"sources":["C:/workspace/ddhub/ddhub/node_modules/.pnpm/@eclipse-scout+core@22.0.41/node_modules/@eclipse-scout/core/src/menu/ContextMenuPopupLayout.js"],"sourcesContent":["/*\n * Copyright (c) 2014-2018 BSI Business Systems Integration AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *     BSI Business Systems Integration AG - initial API and implementation\n */\nimport {graphics, HtmlComponent, PopupLayout, scrollbars} from '../index';\n\nexport default class ContextMenuPopupLayout extends PopupLayout {\n\n  constructor(popup) {\n    super(popup);\n  }\n\n  _setSize(prefSize) {\n    if (this.popup.bodyAnimating) {\n      scrollbars.update(this.popup.get$Scrollable());\n      return;\n    }\n    super._setSize(prefSize);\n    scrollbars.update(this.popup.get$Scrollable());\n    let htmlBody = HtmlComponent.get(this.popup.$body);\n    htmlBody.pack();\n  }\n\n  invalidate(htmlSource) {\n    // If a child triggers a layout invalidation, the popup needs to be resized.\n    // This will happen for sure if a child is an image which will be loaded during the animation.\n    // Ideally, the running animations would be stopped, the popup layouted, the animations adjusted to the new bounds and then continued.\n    // This is currently too complicated to implement, so instead we let the animations finish and resize the popup at the end (but before other resize animations start).\n    if (this.popup.bodyAnimating && htmlSource && htmlSource.isDescendantOf(this.popup.htmlComp)) {\n      this.popup._toggleSubMenuQueue.unshift(() => {\n        if (!this.popup.rendered) {\n          return;\n        }\n        let oldOffset = this.popup.$body.data('text-offset');\n        this.popup._adjustTextAlignment();\n        this.popup.animateResize = true;\n        this.resizeAnimationDuration = this.popup.animationDuration;\n        this.popup.revalidateLayoutTree();\n        this.popup.animateResize = false;\n        this.popup._animateTextOffset(this.popup.$body, oldOffset);\n        this.popup.$container.promise().done(() => this.popup._processSubMenuQueue());\n      });\n    }\n  }\n\n  preferredLayoutSize($container, options) {\n    let htmlComp = this.popup.htmlComp;\n    let htmlBody = HtmlComponent.get(this.popup.$body);\n    let prefSize;\n    if (this.popup.bodyAnimating) {\n      prefSize = graphics.size(this.popup.$body, options);\n    } else {\n      let popupStyleBackup = this.popup.$container.attr('style');\n      let $siblingBodies = this.popup.$body.siblings('.context-menu');\n      $siblingBodies.addClass('hidden');\n      this.popup.$body.css({\n        width: 'auto',\n        height: 'auto'\n      });\n\n      htmlBody = HtmlComponent.get(this.popup.$body);\n      prefSize = htmlBody.prefSize(options);\n\n      $siblingBodies.removeClass('hidden');\n      this.popup.$container.attr('style', popupStyleBackup);\n    }\n    return prefSize\n      .add(htmlComp.insets())\n      .add(htmlBody.margins());\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}